mode: train
dataloader:
  train:
    _target_: dataloaders.CGEODataset
    path_hr: null
    path_lr: null
  val:
    _target_: dataloaders.CGEODataset
    path_hr: null
    path_lr: null
  path_seg: C:\Users\Eliton\Documents\master\unet\data\train\annotation
  n_classes: 4
  weight_classes: []
  augmentation:
    aug1: '...'
archs:
  netG:
    _target_: models.rrdb_arch.RRDBNet
    num_in_ch: 3
    num_out_ch: 3
    num_feat: 64
    num_block: 23
  netD:
    _target_: models.vgg_arch.VGG128
    num_in_ch: 3
    num_feat: 64
  netSeg:
    _target_: models.model_unet_resnet.UNetResNet
    n_classes: 4
trainer:
  _trainer_: null
  optimizer:
    type: null
    lr: null
  scheduler:
    type: null
    milestones: null
    gamma: null
  use_seg: true
  arch_enc: unet
  use_pretrained_seg: true
  path_pretrained_seg: epochs/unet-resnet-100.pth
  use_pretrained_sr: true
  path_pretrained_g: epochs/seg1-new-sr-only_g.pth
  path_pretrained_d: epochs/seg1-new-sr-only_d.pth
  begin_seg: 0.0
  num_epochs: 20
  scheduler_milestones:
  - 50
  - 100
  - 150
  - 200
  scheduler_gamma: 0.1
  batch_size: 4
  crop_size: 256
  upscale_factor: 4
  lr: 0.001
  model_save_path: epochs/
  model_name: teste_seg
  use_aug: true
  save_best: psnr
  losses:
    il:
      _target_: losses.L1Loss
      loss_weight: 1.0
    adv:
      _target_: losses.GANLoss
      gan_type: vanilla
      loss_weight: 1.0
    per:
      _target_: losses.PerceptualLoss
      layer_weights:
        conv5_4: 1
      perceptual_weight: 1.0
    tv:
      _target_: losses.WeightedTVLoss
      loss_weight: 1.0
    seg:
      _target_: losses.SegLoss
      loss_weight: 1.0
      weight_classes: []
val:
  visualize: true
  batch_size: 1
  freq: 10
  n_chunks: 3
test:
  batch_size: 1
  upscale_factor: 4
  path_encoder: epochs/200_noseg_encoder.pth
  path_image: data/LR/2953-3-SO_1_LR.png
  path_save: results/test
  prefix_save: seg
